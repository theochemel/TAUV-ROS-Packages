# tauv_config
This folder contains all packages necessary for managing vehicle configuration.

# tauv_config package
Inside this folder is a package of the same name. This package does two things:

 1. Contain vehicle-common configuration data. This could include state enumerations, exception lists, mission configuration info, etc.
 2. Declare dependencies on the other vehicle configuration packages, such as manta_description or albatross_description. This allows other packages to depend only on tauv_config and get access to any vehicle's configuration info. This prevents chasing down dependencies when adding new vehicle configurations

# What's in a vehicle_description package?
## launch
(Note: namespace is the vehicle name)
This folder contains an "upload" launch file that:
 1. Runs Xacro to generate the URDF and post it in the robot_description package
 2. Spawns the vehicle in the simulator, if necessary
 3. Starts the robot_state_publisher node, which publishes the robot's tf frames

## meshes
Meshes for Gazebo. The mesh names are specified in the URDF.
Look up the Gazebo docs, REP 103, and REP 105 for info on how these meshes should be formatted.
See: http://gazebosim.org/tutorials/?tut=import_mesh

## robots
Robot "modes" folder. Each file is a URDF base file. Currently we use the "default.xacro" URDF.

##  urdf
The folder with high-level URDF files. These URDFs depend on some uuv_simulator URDF snippets, so take a look at those if you're lost. Basically, the important parts are the hydrodynamic model, actuator locations/enumeration/models, and sensors.
See: http://wiki.ros.org/urdf on how to use URDF and how to export a handy URDF hierarchy graphic

## TAM.yaml
This is the Thruster Allocation Matrix or TAM. It is generated by the thruster_allocator node if the "generate_tam" argument is set in its launchfile. The TAM has a row for each of the 6 DOF, and a column for each of the 8 thrusters. The TAM should not be manually edited, and is used by the thruster_allocator node to determine thruster mixing for a specified force/torque wrench.
The TAM is generated based on the URDF actuator locations, and MUST be regenerated if you change the URDF or in any way move the thrusters. It is critical that URDF, hardware, and TAM are synchronized.

## thruster_manager.yaml
This is the configuration for the thruster manager, which includes thruster gains and dynamic model information. For the T200 thrusters on Albatross, we use a gain of 50 to indicate that at max normalized input 1, the thrust is 50*1^2, or 50N. Max thrust is set to 40 for now, but could likely decreased further. The 50N figure is obtained *roughly* from the Blue Robotics documentation for the T200 thrusters. We also configure an FCN model, which means tau = gain\*abs(x)\*x, which approximates the force curves for the T200 thrusters

## vehicle_params.yaml
This file contains any other vehicle-specific rosparams, and is loaded into the ROS parameter server by the system.launch launchfile in tauv_mission. For example, driver configurations, thruster inversions, sensor configurations, and other info is in here.

# How do I add a new vehicle?
My recommendation is to copy an existing vehicle such as Albatross and edit it, although this will require heavy searching, since the vehicle name "albatross" is hard-coded in many places in the albatross_description package.
Alternatively, you can generate a boilerplate robot configuration that includes the meshes, launchfiles, urdf, robots, and package info by following this guide: https://uuvsimulator.github.io/packages/uuv_simulator/docs/tutorials/create_new_vehicle/. You will need to create a new vehicle_params.yaml file and thruster_manager.yaml file, and generate a new TAM if you do that.
